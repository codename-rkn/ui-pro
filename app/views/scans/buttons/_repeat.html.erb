<%
   msg = 'Are you sure you want to repeat this scan'

   if scan.scheduled?
       msg << " ahead of schedule?\n"

       if scan.schedule.recurring?
           msg << 'The time of subsequent occurrences will be adjusted based on this run.'
       else
           msg << 'The next scheduled occurrence will be cancelled.'
       end
   else
       msg << '?'
   end
%>
<%= link_to repeat_site_scan_path( scan.site, scan ),
            title: 'Repeat scan ASAP',
            data: {
              turbo_method: :post,
              turbo_confirm: msg
            },
            class: 'btn btn-sm btn-success' do %>
    <i class="fas fa-redo"></i>
<% end %>
