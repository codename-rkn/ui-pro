<div id="entries-summary">
    <% if @site.scanned? %>
        <% if data[:entries].any? %>
            <div class="row">
              <% if data[:entries].count > 1 %>
                <div class="row">
                  <div class="col-md-12">
                    <%= render partial: 'shared/scan_results/entries/statistics',
                               locals: {
                                 data: data
                               } %>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-12">
                    <%= render partial: 'shared/scan_results/entries/chart',
                               locals: {
                                 data: data[:chart_data]
                               } %>
                  </div>
                </div>
              <% end %>
            </div>
            <div class="row">
                <div class="col-md-3 summary-sitemap-container" id="summary-sitemap">
                    <%= render partial: 'shared/scan_results/entries/sitemap',
                               locals: {
                                       data: data
                               } %>
                </div>

                <div class="col-md-9">
                    <div class="row">
                        <div class="col-md-12" id="entries-filter-container">
                            <%= render partial: 'shared/scan_results/entries/filter',
                                       locals: {
                                               data: data
                                       } %>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12" id="summary-data">
                            <div class="row">
                                <div class="col-md-12 summary-entries-container" id="summary-entries">
                                    <%= render partial: 'shared/scan_results/entries/list',
                                               locals: {
                                                   id: 'summary',
                                                   data: data
                                           } %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <% else %>
            <% if @sitemap_entry %>
                <div class="well">
                    <p>
                        No entries for
                        <%= link_to_url_with_external(
                                    external: @sitemap_entry.url,
                                    internal: sitemap_entry_url( @sitemap_entry ),
                                    display_path_only: true
                            )
                        %>

                        <% if data[:sitemap_data][:entry_count] > 0 %>
                            , see entries for <%= link_to 'all pages', filter_params_without_page %>.
                        <% else %>
                            or any other page, <%= link_to 'clear all filters' %>.
                        <% end %>
                    </p>

                    <%
                       revisions_with_entries = filter_states( @sitemap_entry.entries ).unique_revisions
                       if revisions_with_entries.any?
                    %>
                        <div>
                            You can visit revisions and scans which have logged entries for it:

                            <ul>
                                <% revisions_with_entries.each do |revision| %>
                                <li>
                                    <%= link_to revision,
                                                site_scan_revision_path(
                                                        revision.scan.site,
                                                        revision.scan,
                                                        revision,
                                                        filter_params
                                                ) %>
                                    of
                                    <%= link_to (@scan == revision.scan) ? 'this scan' : revision.scan,
                                                site_scan_path(
                                                        revision.scan.site,
                                                        revision.scan,
                                                        filter_params
                                            ) %>.
                                </li>
                                <% end %>
                            </ul>
                        </div>
                    <% end %>
                </div>
            <% else %>
                <p class="alert alert-info">
                    No entries.
                </p>
            <% end %>
        <% end %>

    <% if data[:missing_entries]&.any? %>
      <h3>Missing</h3>
      <p class="alert alert-warning">
        These entries were logged by previous revisions but not identified by this one.<br/>
        This could be an indication that the entries have been fixed or environmental conditions
        are obstructing the scan (like network or server stress &#8212; you can find out in
        the <a href="health">Health</a> display).
      </p>
      <div class="row">
        <div class="col-md-12 summary-entries-container" id="summary-entries">
          <%= render partial: 'shared/scan_results/entries/list',
                     locals: {
                       id: 'summary',
                       data: { entries: data[:missing_entries] },
                       force_show_logged_by: true
                     } %>
        </div>
      </div>

<% end %>

    <% else %>
        <p class="alert alert-info">
            No scan has started yet...
        </p>
    <% end %>
</div>
