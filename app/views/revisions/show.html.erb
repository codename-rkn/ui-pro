<%
   title "Revision ##{@revision.index}"
   breadcrumb_add 'Sites', sites_path
   breadcrumb_add @site.url, site_path( @site )
   breadcrumb_add @scan.name, site_scan_path( @site, @scan )
%>

<div class="row">
    <div class="col-md-12" id="revision-info">
        <h1>
            <%= link_to "Revision ##{@revision.index}", [@revision.scan.site, @revision.scan, @revision] %> of
            <%= link_to @revision.scan.name, [@revision.scan.site, @revision.scan] %>
            (<%= link_to @scan.profile, @scan.profile %>)
            for
            <%= link_to_url_with_external external: @site.url, internal: @site %>
        </h1>

        <div class="description">
            <%= md @scan.description %>
        </div>

        <p class="text-muted">
            <% if @scan.schedule.recurring? %>
                Running <%= link_to @scan.schedule, '#' %>.
            <% end %>
        </p>

        <% if @revision.stopped? %>
            <p class="text-muted" id="revision-info-time">
                Started on <%= l @revision.started_at %>,
                stopped on <%= l @revision.stopped_at %>
                &mdash;
                <%= Arachni::Utilities.seconds_to_hms @revision.stopped_at - @revision.started_at %>.
            </p>
        <% elsif @revision.in_progress? %>
            <p class="text-muted" id="revision-info-time">
                <i class="fa fa-spin fa-circle-o-notch"></i>
                Started on <%= l @revision.started_at %>
                &mdash;
                <%= Arachni::Utilities.seconds_to_hms Time.now - @revision.started_at %>.
            </p>
        <% end %>
    </div>
</div>

<hr/>

<div class="row">
    <div id="sidebar" class="col-md-2">
        <%= render partial: 'scans/sidebar' %>
    </div>

    <div id="scan-data" class="col-md-10">
        <% if @issues_summary %>
            <%= render partial: 'shared/issues_summary' %>
        <% else %>
            No revisions...
        <% end %>
    </div>
</div>
