<div class="page-header">
    <h1>
        <%= @entry.type.name %>
        <span class="text-muted fs-6">
            <% if @entry.input_vector.affected_input_name %>
                in <%= @entry.input_vector %> input
                <code><%= @entry.input_vector.affected_input_name %></code>
            <% end %>

            at
            <%= link_to_url_with_external(
                    external: @entry.referring_page.dom.url,
                    internal: site_path(
                        @site,
                        sitemap_entry_url( entry.referring_page.sitemap_entry )
                    ),
                    display_path_only: true
                )
            %>
            pointing to
            <%= link_to_url_with_external(
                    external: @entry.input_vector.action,
                    internal: site_path(
                        @site,
                        sitemap_entry_url( entry.input_vector.sitemap_entry )
                    ),
                    display_path_only: true
                )
            %>.
        </span>
    </h1>

    <h3>
        <p class="pull-left badge label-severity-<%= @entry.severity.to_s.downcase %>">
            <%= @entry.severity.to_s.capitalize %> severity
        </p>
    </h3>
</div>

<%
   has_references = (@entry.type.references.any? || @entry.type.cwe) ? true : nil
%>

<div class="row" id="info">
    <div class="col-md-<%= has_references ? 10 : 12 %>">
        <div class="description">
            <%= md @entry.type.description %>
        </div>
    </div>

    <% if has_references %>
    <div class="col-md-2 references">
        <strong>References</strong>

        <ul class="list-unstyled">
            <% if @entry.type.cwe_url %>
            <li>
                <%= link_to 'CWE', @entry.type.cwe_url, target: '_blank' %>
            </li>
            <% end %>

            <% @entry.type.references.each do |reference| %>
                <li>
                    <%= link_to reference.title, reference.url, target: '_blank' %>
                </li>
            <% end %>
        </ul>
    </div>
    <% end %>
</div>

<hr/>

<div class="mt-3" id="input_vector">
    <h2>
        <a class="anchor" href="#!/input_vector">
            <span class="fa fa-link"></span>
        </a>

        Input vector
    </h2>
    <%= render 'entries/input_vector', entry: entry %>
</div>

<hr/>

<div class="mt-3" id="reproduction">
    <h2>
        <a class="anchor" href="#!/reproduction">
            <span class="fa fa-link"></span>
        </a>

        Reproduction
    </h2>

    <%= render 'entries/reproduction', entry: entry %>
</div>

<hr/>

<% if @entry.has_proofs? %>
<div class="mt-3" id="identification">
    <h2>
        <a class="anchor" href="#!/identification">
            <span class="fa fa-link"></span>
        </a>

        Identification
    </h2>

    <%= render 'entries/identification', entry: entry %>
</div>

<hr/>
<% end %>

<% if @entry.type.remedy_guidance %>
    <div class="mt-3" id="remediation">
        <h2>
            <a class="anchor" href="#!/remediation">
                <span class="fa fa-link"></span>
            </a>

            Remediation
        </h2>

        <%= render 'entries/remediation', entry: entry %>
    </div>

    <hr/>
<% end %>

<div class="mt-3" id="advanced">
    <h2>
        <a class="anchor" href="#!/advanced">
            <span class="fa fa-link"></span>
        </a>

        Advanced information
    </h2>

    <p class="text-muted">
        The following sections provide all available data regarding the
        state of the web application and associated traffic.
    </p>

    <%= render 'entries/advanced', entry: entry %>
</div>
