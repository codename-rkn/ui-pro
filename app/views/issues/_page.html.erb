<% if page.dom.transitions.any? %>
    <div class="row">
        <div class="col-md-12">
            <h3>
                <a id="<%= id %>_transitions" class="anchor"
                   href="<%= id_to_location "#{id}_transitions" %>">
                    <span class="fa fa-link"></span>
                </a>

                Transitions
            </h3>

            <p class="text-muted">
                Transitions describe the steps required to restore the state
                of the page, to the one it had when it was processed by the
                scanner, as a series of events.

                In essence, each transition represents a user interaction.
            </p>

            <%= render 'issues/page/transitions', page: page, id: id %>
        </div>
    </div>
<% end %>

<% if page.dom.data_flow_sinks.any? %>
    <div class="row">
        <div class="col-md-12">
            <h3>
                <a id="<%= id %>_data_flow" class="anchor"
                   href="<%= id_to_location "#{id}_data_flow" %>">
                    <span class="fa fa-link"></span>
                </a>

                Data-flow sinks
            </h3>

            <p class="text-muted">
                Data-flow sinks track the flow of the injected taint through
                key points in the Javascript environment of the page.

                Each sink is a function which was passed tainted arguments.
            </p>

            <%= render 'issues/page/sink/data_flow', page: page, id: id %>
        </div>
    </div>
<% end %>

<% if page.dom.execution_flow_sinks.any? %>
    <div class="row">
        <div class="col-md-12">
            <h3>
                <a id="<%= id %>_execution_flow" class="anchor"
                   href="<%= id_to_location "#{id}_execution_flow" %>">
                    <span class="fa fa-link"></span>
                </a>

                Execution-flow sinks
            </h3>

            <p class="text-muted">
                Execution-flow sinks log the successful execution of an injected
                Javascript payload within the page's Javascript environment.

                Each sink is a point of payload execution.
            </p>

            <%= render 'issues/page/sink/execution_flow', page: page, id: id %>
        </div>
    </div>
<% end %>

<% if !page.request.to_s.empty? || !page.response.to_s.empty? %>

    <h3>
        <a id="<%= id %>_http" class="anchor"
           href="<%= id_to_location "#{id}_http" %>">
            <span class="fa fa-link"></span>
        </a>

        HTTP
    </h3>

    <div class="row">
        <% if !page.request.to_s.empty? %>
        <div class="col-md-6">
            <h4>
                <a id="<%= id %>_http_request" class="anchor"
                   href="<%= id_to_location "#{id}_http_request" %>">
                    <span class="fa fa-link"></span>
                </a>

                Request
            </h4>

            <p class="text-muted">
                Raw HTTP request used to retrieve the page.
            </p>

            <pre class="code-container"><%= page.request %></pre>
        </div>
        <% end %>

        <% if !page.response.to_s.empty? %>
        <div class="col-md-6">
            <h4>
                <a id="<%= id %>_http_response" class="anchor"
                   href="<%= id_to_location "#{id}_http_response" %>">
                    <span class="fa fa-link"></span>
                </a>

                Response
            </h4>

            <p class="text-muted">
                Raw HTTP response used as the page basis.

                (Binary bodies will not be displayed.)
            </p>

            <pre id="proof-container" class="code-container"><%= highlight_proof( page.response.to_s, issue.proof ).html_safe %></pre>
        </div>
        <% end %>
    </div>
<% end %>

<%= render 'issues/page/body', page: page, id: id %>
