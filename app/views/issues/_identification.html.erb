<%= render 'issues/identification/remarks',  issue: issue %>
<%= render 'issues/identification/platform', issue: issue %>

<% if !issue.signature.to_s.empty? || !issue.proof.to_s.empty? %>
<table class="table table-condensed table-fixed">
    <thead>
        <tr>
            <% if issue.signature %>
                <th>
                    Signature

                    <a href="#" rel="tooltip"
                       title="This signature was used to detect the issue.">
                        <i class="fa fa-info"></i>
                    </a>
                </th>
            <% end %>

            <% if issue.proof %>
                <th>
                    Proof

                    <a href="#" rel="tooltip"
                       title="This string was used to verify the existence of the issue.">
                        <i class="fa fa-info"></i>
                    </a>
                </th>
            <% end %>

        </tr>
    </thead>
    <tr>
        <% if issue.signature %>
            <td>
                <%= code_highlight issue.signature %>
            </td>
        <% end %>

        <% if issue.proof %>
            <td>
                <%= code_highlight( issue.proof ) %>
            </td>
        <% end %>
    </tr>
</table>
<% end %>

<% if !@issue.proof.to_s.empty? && !@issue.page.response.to_s.empty? %>

    <% if @issue.page.dom.transitions.any? %>
        <pre class="highlight-container code-container"><%= highlight_proof( @issue.page.dom.body.to_s, @issue.proof ).html_safe %></pre>

        <p class="text-muted">
            Evaluated browser DOM.
        <p>
    <% else %>
        <pre class="highlight-container code-container"><%= highlight_proof( @issue.page.response.to_s, @issue.proof ).html_safe %></pre>

        <p class="text-muted">
            Raw HTTP response - binary bodies will not be displayed.
        </p>
    <% end %>

<% end %>

<% if @issue.page.dom.execution_flow_sinks.any? %>
    <p>
        This issue is accompanied by successful execution of a JavaScript payload:
    </p>

    <%= render 'issues/advanced/page/sink/execution_flow',
               page: @issue.page,
               id:   'identification' %>
<% end %>
