<% if !(role = @scan.site_role).guest? %>
    <div class="alert alert-info" id="reproduction-site-role">
        This entry was identified by logging in as
        <a target="_blank" href="<%= site_path @site %>#!/roles/<%= role.id %>"><%= role %></a>,
        it is likely that you will need the same privileges in order to reproduce it.
    </div>
<% end %>

<% if entry.active? && entry.input_vector.inputs.any? %>
    <div id="reproduction-inputs">
        In order to reproduce the entry please submit the
        <a href="#!/input_vector">input vector</a> with the following values:

        <%= render '/shared/hash',
                   object: entry.input_vector.inputs,
                   highlight: entry.input_vector.affected_input_name,
                   code: true
        %>
    </div>
<% end %>

<% if entry&.page&.dom&.transitions&.any? %>
    <div id="reproduction-transitions">
        <p>
            This entry requires a series of browser-based interface interactions
            in order to bring the page to a vulnerable state:
        </p>

        <%= render 'entries/advanced/page/transitions',
                   page: entry.page,
                   id:   'reproduction' %>
    </div>
<% elsif entry&.page&.request %>
    <div id="reproduction-request">
        <pre class="highlight-container code-container"><%= highlight_http_request( entry.page.request.to_s, entry, entry.input_vector.seed.to_s ) || entry.page.request %></pre>
    </div>
<% end %>
