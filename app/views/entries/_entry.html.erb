<div class="page-header">
    <h1>
        <span class="text-muted fs-4">
            <% if @entry.input_vector.affected_input_name %>
                <%= @entry.input_vector %> input
                <code><%= @entry.input_vector.affected_input_name %></code>
            <% end %>

            at
            <%= link_to_url_with_external(
                    external: @entry.referring_page.dom.url,
                    internal: site_path(
                        @site,
                        sitemap_entry_url( entry.referring_page.sitemap_entry )
                    ),
                    display_path_only: true
                )
            %>
            pointing to
            <%= link_to_url_with_external(
                    external: @entry.input_vector.action,
                    internal: site_path(
                        @site,
                        sitemap_entry_url( entry.input_vector.sitemap_entry )
                    ),
                    display_path_only: true
                )
            %>
        </span>
    </h1>

  <h3>
    <span class="text-muted fs-5">
      with sinks
      <span class="pull-left badge label-severity-none">
        <%= @entry.sinks.map(&:name).join( ", " ) %>
      </span>

      and platforms
      <span class="pull-left badge label-severity-none">
        <%= @entry.platforms.map(&:name).join( ", " ) %>
      </span>
    </span>
  </h3>

</div>

<hr/>

<div class="mt-3" id="input_vector">
    <h2>
        <a class="anchor" href="#!/input_vector">
            <span class="fa fa-link"></span>
        </a>

        Input vector
    </h2>
    <%= render 'entries/input_vector', entry: entry %>
</div>

<hr/>

<div class="mt-3" id="reproduction">
    <h2>
        <a class="anchor" href="#!/reproduction">
            <span class="fa fa-link"></span>
        </a>

        Reproduction
    </h2>

    <%= render 'entries/reproduction', entry: entry %>
</div>

<hr/>

<% if @entry.has_proofs? && @entry.page && (!@entry.page.response.to_s.empty? ||
  @entry&.page&.dom&.execution_flow_sinks&.any?) %>
<div class="mt-3" id="identification">
    <h2>
        <a class="anchor" href="#!/identification">
            <span class="fa fa-link"></span>
        </a>

        Identification
    </h2>

    <%= render 'entries/identification', entry: entry %>
</div>

<hr/>
<% end %>

<div class="mt-3" id="advanced">
    <h2>
        <a class="anchor" href="#!/advanced">
            <span class="fa fa-link"></span>
        </a>

        Advanced information
    </h2>

    <p class="text-muted">
        The following sections provide all available data regarding the
        state of the web application and associated traffic.
    </p>

    <%= render 'entries/advanced', entry: entry %>
</div>
